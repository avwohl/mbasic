100 REM PROGRAM BY C. VAN DER KAAY (2023)
120 REM ********************************
140 REM * PROGRAM INITIALIZATION PHASE *
160 REM ********************************
180 REM CLEAR THE SCREEN ON START
200 PRINT CHR$(26)
220 REM POSITION AND PRINT THE TITLE IN THE CENTER (APPROXIMATELY)
240 PRINT CHR$(27) + "=" + CHR$(12) + CHR$(40); "PRIME NUMBER GENERATOR";
260 PRINT
280 PRINT CHR$(27) + "=" + CHR$(10) + CHR$(41); "WELCOME TO THE PRIME NUMBER GENERATOR!";
300 PRINT "* THIS PROGRAM IS TAILORED FOR THE KAYPRO II SYSTEM.";
320 PRINT "* USING THIS TOOL, YOU CAN FIND AND LIST PRIME NUMBERS";
340 PRINT "* WITHIN A SPECIFIED RANGE.";
360 PRINT "* BEGIN BY PROVIDING A STARTING AND ENDING VALUE. THE";
380 PRINT "* PROGRAM WILL THEN DISPLAY ALL THE PRIME NUMBERS WITHIN";
400 PRINT "* THAT INTERVAL. AFTER EXECUTION, YOU'LL RECEIVE SOME";
420 PRINT "* STATISTICAL DATA, LIKE THE TOTAL PRIMES FOUND,";
440 PRINT "* AND A COMPARISON TO THE TOTAL NUMBERS CHECKED.";
460 PRINT
480 PRINT "* NOW, PLEASE PROVIDE THE RANGE BELOW.";
500 REM PROMPT USER FOR THE RANGE OF PRIME SEARCH
520 REM POSITIONING CURSOR FOR "START" INPUT
540 PRINT CHR$(7)
560 PRINT CHR$(27) + "=" + CHR$(20) + CHR$(25); "FROM WHAT NUMBER DO YOU WANT TO START"
580 INPUT START
600 REM POSITIONING CURSOR FOR "END" INPUT
620 PRINT CHR$(7)
640 PRINT CHR$(27) + "=" + CHR$(22) + CHR$(25); "UP TO WHAT NUMBER DO YOU WANT TO GENERATE PRIMES"
660 INPUT N
680 REM ENSURE START IS AT LEAST 2, AS 1 IS NOT PRIME
700 IF START < 2 THEN START = 2
720 REM INITIALIZE PRIME COUNTER AND EFFORT COUNTER TO ZERO
740 PRIMECOUNT = 0
760 EFFORTCOUNT = 0
780 REM CLEAR PREVIOUS OUTPUTS BEFORE LISTING PRIMES
800 PRINT CHR$(23)
820 REM LOOP THROUGH EACH NUMBER FROM START TO N TO CHECK FOR PRIMALITY
840 FOR I = START TO N
860 REM ASSUME NUMBER IS PRIME AT START
880 PRIME = 1
900 ' OPTIMIZED PRIME CHECK: GO ONLY UP TO SQUARE ROOT
920 FOR J = 2 TO SQR(I)
940 REM INCREMENT EFFORT COUNTER
960 EFFORTCOUNT = EFFORTCOUNT + 1
980 REM RESET TEMP TO THE VALUE OF I
1000 TEMP = I
1020 REM SUBTRACT J FROM TEMP UNTIL TEMP < J TO FIND REMAINDER
1040 WHILE TEMP >= J
1060 TEMP = TEMP - J
1080 WEND
1100 REM IF REMAINDER IS ZERO, THE NUMBER IS NOT PRIME
1120 IF TEMP = 0 THEN PRIME = 0: GOTO 265
1140 NEXT J
1160 REM IF NUMBER IS PRIME, PRINT IT AND INCREASE THE PRIME COUNTER
1180 IF PRIME = 1 THEN PRINT I; " ";: PRIMECOUNT = PRIMECOUNT + 1
1200 NEXT I
1220 PRINT CHR$(7)
1240 REM POSITIONING CURSOR FOR OUTPUT
1260 PRINT CHR$(27) + "=" + CHR$(23) + CHR$(25);
1280 PRINT "TOTAL NUMBERS CHECKED: "; N - START + 1
1300 PRINT "TOTAL PRIMES FOUND: "; PRIMECOUNT
1320 REM CALCULATE AND DISPLAY THE PERCENTAGE OF PRIMES IN THE RANGE
1340 PRIMEPERCENT = (PRIMECOUNT / (N - START + 1)) * 100
1360 PRINT "PERCENTAGE OF PRIME NUMBERS: "; PRIMEPERCENT; "%"
1380 PRINT "CPU EFFORT (IN LOOP COUNTS): "; EFFORTCOUNT
1400 REM PROMPT THE USER TO RESTART OR EXIT
1420 REM POSITIONING CURSOR FOR RESTART QUERY
1440 PRINT CHR$(7)
1460 PRINT CHR$(27) + "=" + CHR$(25) + CHR$(25); "DO YOU WANT TO RESTART? (Y/N)"
1480 INPUT ANSWER$
1500 IF ANSWER$ = "Y" OR ANSWER$ = "Y" THEN PRINT CHR$(26): GOTO 25
1520 REM END PROGRAM ELEGANTLY
1540 PRINT CHR$(26)  ' CLEAR THE SCREEN
1560 REM END OF THE PROGRAM
1580 END
