10 PRINT"STRIP - March 20, 1982
20 DEFINT A-Z
30 PRINT:INPUT"Enter name of the 'source file':  ",F$
40 X$=F$:GOSUB 350:F$=Y$
50 PRINT:INPUT"Enter name of the 'destination file':  ",F2$
55 PRINT:PRINT
60 X$=F2$:GOSUB 350:F2$=Y$
70 :REMARK

  OPEN FILE AND TEST TO BE SURE IT'S ASCII

80 OPEN"I",1,F$
90 LINE  INPUT#1,L$
100 IF  ASC(LEFT$(L$,1))=255  THEN 110 :ELSE 140
110  PRINT"Program is saved in binary form.  Load it and save it with
120  PRINT"the 'A' option, then run STRIP again.
130  PRINT:PRINT:END
140 :REMARK

  START STRIPPING
  If an apostrophe is found, the rest of the line is cut off,
  except inside a quoted string.

150 OPEN"O",2,F2$
160 LENGTH=LEN(L$):QUOTE=0
170 :REMARK

 CRANK THRU THE LINE CHAR BY CHAR

180 FOR J=1  TO LENGTH
190  A$=MID$(L$,J,1)
200  IF A$=CHR$(34)  THEN 210 :ELSE 230
210   IF QUOTE=0  THEN QUOTE=1:GOTO 240
220   IF QUOTE=1  THEN QUOTE=0:GOTO 240
230  IF QUOTE=0  AND A$="'"  THEN 320
240 NEXT
250 :REMARK
 PRINT THE LINE

260 PRINT#2,L$
270 PRINT L$
280 :REMARK

 GET THE NEXT LINE

290 IF [0xFF][AF](1)  THEN 292 :ELSE 300
292  CLOSE
294  PRINT:PRINT"All done.":PRINT:END
300 LINE  INPUT#1, L$
310 GOTO 160
320 :REMARK

 TRUNCATE LINE

330 L$=LEFT$(L$,J)
340 GOTO 250
350 :REMARK

    (SUB) UCV

360 Y$=""
370 FOR K=1  TO  LEN(X$)
380  Y$=Y$+" "
390  X=ASC(MID$(X$,K,1))
400  IF 96<X  AND X<123  THEN  MID$(Y$,K,1)=CHR$(X-32):GOTO 420
410  MID$(Y$,K,1)=MID$(X$,K,1)
420 NEXT
430 RETURN
6682 
380  Y$=Y$+" "
390  X=ASC(MID$(X$,K,1))
400  IF 96<X  AND X<123  THEN  MID$(Y$,K,1)=CHR$(X-32):GOTO 420
