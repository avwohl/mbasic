
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Complete documentation for MBASIC 5.21 interpreter - MBASIC-80 for CP/M implemented in Python (includes developer docs)">
      
      
        <meta name="author" content="MBASIC Project Contributors">
      
      
        <link rel="canonical" href="https://avwohl.github.io/mbasic/history/PHASE4_DYNAMIC_LOADING_PROGRESS/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Phase 4: Dynamic Backend Loading - COMPLETE ✅ - MBASIC 5.21 Documentation (Full)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#phase-4-dynamic-backend-loading-complete" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MBASIC 5.21 Documentation (Full)" class="md-header__button md-logo" aria-label="MBASIC 5.21 Documentation (Full)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MBASIC 5.21 Documentation (Full)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Phase 4: Dynamic Backend Loading - COMPLETE ✅
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/avwohl/mbasic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    avwohl/mbasic
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../help/mbasic/getting-started/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../library/" class="md-tabs__link">
          
  
  
  Library

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../dev/" class="md-tabs__link">
        
  
  
    
  
  Developer Docs

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MBASIC 5.21 Documentation (Full)" class="md-nav__button md-logo" aria-label="MBASIC 5.21 Documentation (Full)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MBASIC 5.21 Documentation (Full)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/avwohl/mbasic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    avwohl/mbasic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/mbasic/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started with MBASIC (Interpreter)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/mbasic/features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MBASIC Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/mbasic/compatibility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MBASIC Compatibility Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Library
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MBASIC Program Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/games/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Games
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/education/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Education
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/business/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/electronics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Electronics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/ham_radio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ham Radio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/data_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/telecommunications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Telecommunications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/demos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Docs
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#completed-work" class="md-nav__link">
    <span class="md-ellipsis">
      Completed Work
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Completed Work">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-command-line-argument-parsing" class="md-nav__link">
    <span class="md-ellipsis">
      1. Command-Line Argument Parsing ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-dynamic-backend-loading" class="md-nav__link">
    <span class="md-ellipsis">
      2. Dynamic Backend Loading ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-refactored-main-function" class="md-nav__link">
    <span class="md-ellipsis">
      3. Refactored main() Function ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-backward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      4. Backward Compatibility ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      5. Error Handling ✅
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-results" class="md-nav__link">
    <span class="md-ellipsis">
      Test Results ✅
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-loading-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Loading Flow ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benefits-of-dynamic-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of Dynamic Loading ✅
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files-modified" class="md-nav__link">
    <span class="md-ellipsis">
      Files Modified
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Files Modified">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mbasic-refactored-170-lines" class="md-nav__link">
    <span class="md-ellipsis">
      mbasic (refactored, 170 lines)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-previous-phases" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with Previous Phases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration with Previous Phases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-io-abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: I/O Abstraction ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-program-management" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Program Management ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-ui-abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: UI Abstraction ✅
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extensibility-example" class="md-nav__link">
    <span class="md-ellipsis">
      Extensibility Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extensibility Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-new-backend" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a New Backend
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Command-Line Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command-Line Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Backend Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combined-options" class="md-nav__link">
    <span class="md-ellipsis">
      Combined Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impact" class="md-nav__link">
    <span class="md-ellipsis">
      Impact
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Impact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-cli-users" class="md-nav__link">
    <span class="md-ellipsis">
      For CLI Users ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-visual-ui-developers" class="md-nav__link">
    <span class="md-ellipsis">
      For Visual UI Developers ✅
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-future-development" class="md-nav__link">
    <span class="md-ellipsis">
      For Future Development ✅
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git-commit" class="md-nav__link">
    <span class="md-ellipsis">
      Git Commit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Statistics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Next Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-5-mobilevisual-ui-deferred" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: Mobile/Visual UI (Deferred)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/avwohl/mbasic/edit/main/docs/history/PHASE4_DYNAMIC_LOADING_PROGRESS.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="phase-4-dynamic-backend-loading-complete">Phase 4: Dynamic Backend Loading - COMPLETE ✅<a class="headerlink" href="#phase-4-dynamic-backend-loading-complete" title="Permanent link">&para;</a></h1>
<p><strong>Date</strong>: 2025-10-24
<strong>Status</strong>: COMPLETE ✅ - All testing passed</p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>Implemented dynamic backend loading using Python's <code>importlib</code> and added command-line argument parsing to enable users to select different UI backends at runtime. This completes the refactoring plan's core phases (1-4), making the MBASIC interpreter fully embeddable and extensible.</p>
<h2 id="completed-work">Completed Work<a class="headerlink" href="#completed-work" title="Permanent link">&para;</a></h2>
<h3 id="1-command-line-argument-parsing">1. Command-Line Argument Parsing ✅<a class="headerlink" href="#1-command-line-argument-parsing" title="Permanent link">&para;</a></h3>
<p><strong>Refactored mbasic</strong> (170 lines, was 85 lines):</p>
<p><strong>New features:</strong>
- <code>--ui {cli,visual}</code> - Select UI backend (default: cli)
- <code>--debug</code> - Enable debug output
- <code>--help</code> - Show usage information
- Positional argument for program file (unchanged)</p>
<p><strong>Usage examples:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>python3<span class="w"> </span>mbasic<span class="w">                    </span><span class="c1"># Interactive mode (CLI) - backward compatible</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>program.bas<span class="w">        </span><span class="c1"># Run program - backward compatible</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli<span class="w">      </span><span class="c1"># Explicitly use CLI backend</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>visual<span class="w">   </span><span class="c1"># Use visual backend (stub)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--debug<span class="w">            </span><span class="c1"># Enable debug output</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli<span class="w"> </span>--debug<span class="w"> </span>tests/program.bas<span class="w">  </span><span class="c1"># Combined options</span>
</code></pre></div></p>
<p><strong>Key code:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;MBASIC 5.21 Interpreter&#39;</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawDescriptionHelpFormatter</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;program&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;BASIC program file to load and run&#39;</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ui&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cli&#39;</span><span class="p">,</span> <span class="s1">&#39;visual&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;cli&#39;</span><span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--debug&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Enable debug output&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="2-dynamic-backend-loading">2. Dynamic Backend Loading ✅<a class="headerlink" href="#2-dynamic-backend-loading" title="Permanent link">&para;</a></h3>
<p><strong>Created load_backend() function</strong> (mbasic:33-62):</p>
<p><strong>Implementation:</strong>
- Uses <code>importlib.import_module()</code> to load backends dynamically
- Maps backend name to module: <code>'cli'</code> → <code>'ui.cli'</code>
- Gets backend class by name: <code>'CLIBackend'</code>, <code>'VisualBackend'</code>
- Returns instantiated UIBackend instance</p>
<p><strong>Key code:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_backend</span><span class="p">(</span><span class="n">backend_name</span><span class="p">,</span> <span class="n">io_handler</span><span class="p">,</span> <span class="n">program_manager</span><span class="p">):</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a UI backend dynamically using importlib&quot;&quot;&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        <span class="c1"># Import the backend module</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>        <span class="n">backend_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ui.</span><span class="si">{</span><span class="n">backend_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>        <span class="c1"># Get the backend class (CLIBackend, VisualBackend, etc.)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="n">backend_class_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">backend_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">Backend&#39;</span> <span class="k">if</span> <span class="n">backend_name</span> <span class="o">==</span> <span class="s1">&#39;cli&#39;</span> \
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>                             <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">backend_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1">Backend&#39;</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>        <span class="n">backend_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">backend_module</span><span class="p">,</span> <span class="n">backend_class_name</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>        <span class="c1"># Create and return the backend instance</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>        <span class="k">return</span> <span class="n">backend_class</span><span class="p">(</span><span class="n">io_handler</span><span class="p">,</span> <span class="n">program_manager</span><span class="p">)</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load backend &#39;</span><span class="si">{</span><span class="n">backend_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Backend &#39;</span><span class="si">{</span><span class="n">backend_name</span><span class="si">}</span><span class="s2">&#39; does not have class &#39;</span><span class="si">{</span><span class="n">backend_class_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Features:</strong>
- Supports any backend that implements UIBackend interface
- Clear error messages for missing backends or classes
- Extensible: Add new backends without modifying mbasic</p>
<h3 id="3-refactored-main-function">3. Refactored main() Function ✅<a class="headerlink" href="#3-refactored-main-function" title="Permanent link">&para;</a></h3>
<p><strong>New architecture:</strong>
1. Parse command-line arguments
2. Create IOHandler based on backend choice
3. Create ProgramManager with default DEF types
4. Load backend dynamically via importlib
5. Either run program file or enter interactive mode</p>
<p><strong>Key changes:</strong>
- Removed direct InteractiveMode instantiation
- Added backend-specific I/O handler creation
- Integrated ProgramManager for all program operations
- Simplified run_file() to use backend.program.load_from_file()</p>
<p><strong>Code flow:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="c1"># Create I/O handler</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">io_handler</span> <span class="o">=</span> <span class="n">ConsoleIOHandler</span><span class="p">(</span><span class="n">debug_enabled</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="c1"># Create program manager</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">program_manager</span> <span class="o">=</span> <span class="n">ProgramManager</span><span class="p">(</span><span class="n">create_default_def_type_map</span><span class="p">())</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="c1"># Load backend dynamically</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">backend</span> <span class="o">=</span> <span class="n">load_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span> <span class="n">io_handler</span><span class="p">,</span> <span class="n">program_manager</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="c1"># Run program or enter interactive mode</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">program</span><span class="p">:</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>        <span class="n">run_file</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">program</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">debug_enabled</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>        <span class="n">backend</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="4-backward-compatibility">4. Backward Compatibility ✅<a class="headerlink" href="#4-backward-compatibility" title="Permanent link">&para;</a></h3>
<p><strong>Maintained 100% backward compatibility:</strong>
- ✅ <code>python3 mbasic</code> - Works exactly as before (default CLI)
- ✅ <code>python3 mbasic program.bas</code> - Loads and runs program unchanged
- ✅ All existing test files work
- ✅ No changes required to existing BASIC programs
- ✅ InteractiveMode still functions via CLIBackend wrapper</p>
<p><strong>Benefits:</strong>
- Users see no changes (default CLI mode)
- Existing scripts and workflows unaffected
- New features opt-in via <code>--ui</code> flag
- Clean migration path for future UI backends</p>
<h3 id="5-error-handling">5. Error Handling ✅<a class="headerlink" href="#5-error-handling" title="Permanent link">&para;</a></h3>
<p><strong>Comprehensive error handling:</strong>
- ImportError if backend module not found
- AttributeError if backend class doesn't exist
- FileNotFoundError for missing program files
- Parse errors reported with line numbers
- Debug mode shows full stack traces</p>
<p><strong>Example error output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>invalid
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>Error<span class="w"> </span>loading<span class="w"> </span>backend:<span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>backend<span class="w"> </span><span class="s1">&#39;invalid&#39;</span>:<span class="w"> </span>No<span class="w"> </span>module<span class="w"> </span>named<span class="w"> </span><span class="s1">&#39;ui.invalid&#39;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>nonexistent.bas
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>Error:<span class="w"> </span>File<span class="w"> </span>not<span class="w"> </span>found:<span class="w"> </span>nonexistent.bas
</code></pre></div></p>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<h3 id="test-results">Test Results ✅<a class="headerlink" href="#test-results" title="Permanent link">&para;</a></h3>
<p><strong>All tests passed:</strong></p>
<ol>
<li>
<p><strong>Help output</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>--help
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>usage:<span class="w"> </span>mbasic<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>--ui<span class="w"> </span><span class="o">{</span>cli,visual<span class="o">}]</span><span class="w"> </span><span class="o">[</span>--debug<span class="o">]</span><span class="w"> </span><span class="o">[</span>program<span class="o">]</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>MBASIC<span class="w"> </span><span class="m">5</span>.21<span class="w"> </span>Interpreter
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>...
</code></pre></div></p>
</li>
<li>
<p><strong>Default CLI mode</strong> (backward compatible):
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>tests/test_deffn.bas
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>FND<span class="o">(</span><span class="m">10</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">17</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>FNA<span class="o">(</span><span class="m">5</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="nv">FNB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">42</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>Ready
</code></pre></div></p>
</li>
<li>
<p><strong>Explicit CLI backend</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli<span class="w"> </span>tests/test_fn_shadow.bas
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Before<span class="w"> </span>DEF<span class="w"> </span>FN:
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nv">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>...
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Ready
</code></pre></div></p>
</li>
<li>
<p><strong>Visual backend (stub)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>visual
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Note:<span class="w"> </span>Visual<span class="w"> </span>backend<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>stub,<span class="w"> </span>using<span class="w"> </span>console<span class="w"> </span>I/O
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>VisualBackend.start<span class="o">()</span><span class="w"> </span>-<span class="w"> </span>Override<span class="w"> </span>this<span class="w"> </span>method
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>Create<span class="w"> </span>your<span class="w"> </span>UI<span class="w"> </span>here<span class="w"> </span>and<span class="w"> </span>start<span class="w"> </span>event<span class="w"> </span>loop
</code></pre></div></p>
</li>
<li>
<p><strong>Interactive mode</strong> (unchanged):
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>python3<span class="w"> </span>mbasic
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>MBASIC<span class="w"> </span><span class="m">5</span>.21<span class="w"> </span>Interpreter
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Ready
</code></pre></div></p>
</li>
</ol>
<p><strong>Test coverage:</strong>
- ✅ Argument parsing (help, backend, debug)
- ✅ Dynamic backend loading (CLI and visual)
- ✅ Program file execution
- ✅ Interactive mode
- ✅ Error handling (missing files, invalid backends)
- ✅ Backward compatibility (all existing functionality)</p>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<h3 id="dynamic-loading-flow">Dynamic Loading Flow ✅<a class="headerlink" href="#dynamic-loading-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>┌─────────────────────────────────────────────────┐
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>│              mbasic (main)                   │
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>│  1. Parse args (backend, debug, program)        │
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>│  2. Create IOHandler (ConsoleIOHandler)         │
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>│  3. Create ProgramManager (default DEF types)   │
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>│  4. Load backend via importlib                  │
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>│  5. Run program OR start interactive mode       │
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>└────────────────────┬────────────────────────────┘
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>                     │
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>                     ▼
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>          ┌──────────────────────┐
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>          │   load_backend()     │
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>          │  importlib.import()  │
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>          └──────────┬───────────┘
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>                     │
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>         ┌───────────┴──────────────┐
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>         │                          │
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    ┌────▼─────┐             ┌──────▼──────┐
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>    │ ui.cli   │             │ ui.visual   │
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>    │ CLIBack  │             │ VisualBack  │
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>    └────┬─────┘             └──────┬──────┘
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>         │                          │
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>         └──────────┬───────────────┘
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>                    │
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>                    ▼
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>         ┌─────────────────────┐
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>         │   UIBackend         │
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>         │   Interface         │
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>         └─────────────────────┘
</code></pre></div>
<h3 id="benefits-of-dynamic-loading">Benefits of Dynamic Loading ✅<a class="headerlink" href="#benefits-of-dynamic-loading" title="Permanent link">&para;</a></h3>
<p><strong>Extensibility:</strong>
- Add new backends without modifying mbasic
- Create custom backends in separate modules
- Load backends by name at runtime</p>
<p><strong>Flexibility:</strong>
- Switch backends via command line
- Different backends for different use cases
- Easy testing with mock backends</p>
<p><strong>Maintainability:</strong>
- Clear separation between main entry point and backends
- Backend code isolated in ui/ module
- Clean interface contracts (UIBackend)</p>
<h2 id="files-modified">Files Modified<a class="headerlink" href="#files-modified" title="Permanent link">&para;</a></h2>
<h3 id="mbasic-refactored-170-lines">mbasic (refactored, 170 lines)<a class="headerlink" href="#mbasic-refactored-170-lines" title="Permanent link">&para;</a></h3>
<p><strong>Changes:</strong>
- Added <code>argparse</code> for command-line argument parsing
- Added <code>importlib</code> for dynamic backend loading
- Created <code>create_default_def_type_map()</code> helper
- Created <code>load_backend()</code> for dynamic loading
- Refactored <code>run_file()</code> to use ProgramManager
- Refactored <code>main()</code> to use UIBackend architecture</p>
<p><strong>Statistics:</strong>
- <strong>Lines</strong>: 85 → 170 (85 lines added)
- <strong>Imports</strong>: Added <code>argparse</code>, <code>importlib</code>
- <strong>Functions</strong>: 2 → 4 (added <code>create_default_def_type_map</code>, <code>load_backend</code>)
- <strong>Functionality</strong>: Same + backend selection + debug mode</p>
<p><strong>Backward compatibility:</strong>
- ✅ No breaking changes
- ✅ Default behavior unchanged (CLI mode)
- ✅ All existing invocations work</p>
<h2 id="integration-with-previous-phases">Integration with Previous Phases<a class="headerlink" href="#integration-with-previous-phases" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-io-abstraction">Phase 1: I/O Abstraction ✅<a class="headerlink" href="#phase-1-io-abstraction" title="Permanent link">&para;</a></h3>
<p><strong>Used:</strong>
- ConsoleIOHandler for CLI backend
- IOHandler interface for backend creation
- Debug mode passed to ConsoleIOHandler</p>
<p><strong>Integration:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">io_handler</span> <span class="o">=</span> <span class="n">ConsoleIOHandler</span><span class="p">(</span><span class="n">debug_enabled</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">backend</span> <span class="o">=</span> <span class="n">load_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span> <span class="n">io_handler</span><span class="p">,</span> <span class="n">program_manager</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="phase-2-program-management">Phase 2: Program Management ✅<a class="headerlink" href="#phase-2-program-management" title="Permanent link">&para;</a></h3>
<p><strong>Used:</strong>
- ProgramManager for all program operations
- load_from_file() for loading programs
- get_program_ast() for execution</p>
<p><strong>Integration:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">program_manager</span> <span class="o">=</span> <span class="n">ProgramManager</span><span class="p">(</span><span class="n">create_default_def_type_map</span><span class="p">())</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">success</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">program</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">program_path</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="phase-3-ui-abstraction">Phase 3: UI Abstraction ✅<a class="headerlink" href="#phase-3-ui-abstraction" title="Permanent link">&para;</a></h3>
<p><strong>Used:</strong>
- UIBackend interface for backend polymorphism
- CLIBackend for command-line interface
- VisualBackend stub for visual UI</p>
<p><strong>Integration:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">backend</span> <span class="o">=</span> <span class="n">load_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span> <span class="n">io_handler</span><span class="p">,</span> <span class="n">program_manager</span><span class="p">)</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">backend</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># Polymorphic - works with any UIBackend</span>
</code></pre></div></p>
<h2 id="extensibility-example">Extensibility Example<a class="headerlink" href="#extensibility-example" title="Permanent link">&para;</a></h2>
<h3 id="adding-a-new-backend">Adding a New Backend<a class="headerlink" href="#adding-a-new-backend" title="Permanent link">&para;</a></h3>
<p>To add a new backend (e.g., <code>web</code> backend):</p>
<p><strong>1. Create src/ui/web.py:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">UIBackend</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">WebBackend</span><span class="p">(</span><span class="n">UIBackend</span><span class="p">):</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>        <span class="c1"># Start Flask/Django web server</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="c1"># Serve HTML/JavaScript UI</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>        <span class="c1"># Connect to interpreter via WebSocket</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>        <span class="k">pass</span>
</code></pre></div></p>
<p><strong>2. Update mbasic choices:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="s1">&#39;--ui&#39;</span><span class="p">,</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cli&#39;</span><span class="p">,</span> <span class="s1">&#39;visual&#39;</span><span class="p">,</span> <span class="s1">&#39;web&#39;</span><span class="p">],</span>  <span class="c1"># Add &#39;web&#39;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">default</span><span class="o">=</span><span class="s1">&#39;cli&#39;</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="p">)</span>
</code></pre></div></p>
<p><strong>3. Use it:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>web
</code></pre></div></p>
<p><strong>That's it!</strong> No other changes needed. The <code>load_backend()</code> function automatically loads <code>ui.web.WebBackend</code>.</p>
<h2 id="command-line-examples">Command-Line Examples<a class="headerlink" href="#command-line-examples" title="Permanent link">&para;</a></h2>
<h3 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Interactive mode (default CLI)</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>python3<span class="w"> </span>mbasic
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># Run a program</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>program.bas
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># Show help</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--help
</code></pre></div>
<h3 id="backend-selection">Backend Selection<a class="headerlink" href="#backend-selection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Explicitly use CLI backend</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># Use visual backend (stub)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>visual
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># Load program with specific backend</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli<span class="w"> </span>program.bas
</code></pre></div>
<h3 id="debug-mode">Debug Mode<a class="headerlink" href="#debug-mode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Enable debug output</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--debug
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c1"># Debug mode with program</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--debug<span class="w"> </span>program.bas
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># Debug mode with specific backend</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>cli<span class="w"> </span>--debug<span class="w"> </span>program.bas
</code></pre></div>
<h3 id="combined-options">Combined Options<a class="headerlink" href="#combined-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># All options together</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>python3<span class="w"> </span>mbasic<span class="w"> </span>--ui<span class="w"> </span>visual<span class="w"> </span>--debug<span class="w"> </span>program.bas
</code></pre></div>
<h2 id="impact">Impact<a class="headerlink" href="#impact" title="Permanent link">&para;</a></h2>
<h3 id="for-cli-users">For CLI Users ✅<a class="headerlink" href="#for-cli-users" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>No Changes</strong>: Everything works exactly as before</li>
<li><strong>New Options</strong>: Optional <code>--ui</code> and <code>--debug</code> flags</li>
<li><strong>Same Performance</strong>: No overhead from dynamic loading</li>
</ul>
<h3 id="for-visual-ui-developers">For Visual UI Developers ✅<a class="headerlink" href="#for-visual-ui-developers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Easy Integration</strong>: Just create a UIBackend subclass</li>
<li><strong>No Core Changes</strong>: No need to modify mbasic</li>
<li><strong>Clear API</strong>: UIBackend interface well-documented</li>
<li><strong>Examples Available</strong>: VisualBackend provides template</li>
</ul>
<h3 id="for-future-development">For Future Development ✅<a class="headerlink" href="#for-future-development" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Phase 5 Ready</strong>: Can add mobile backends easily</li>
<li><strong>Extensible</strong>: Any new backend just needs to implement UIBackend</li>
<li><strong>Testable</strong>: Can create test backends for unit testing</li>
<li><strong>Maintainable</strong>: Clear separation of concerns</li>
</ul>
<h2 id="git-commit">Git Commit<a class="headerlink" href="#git-commit" title="Permanent link">&para;</a></h2>
<p><strong>Commit hash</strong>: (pending)
<strong>Commit message</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>Implement Phase 4: Dynamic backend loading
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>- Add argparse for command-line argument parsing
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>- Add --ui option (cli/visual)
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>- Add --debug option for debug output
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>- Implement load_backend() with importlib
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>- Refactor main() to use UIBackend architecture
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>- Maintain 100% backward compatibility
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>All tests passing. Phases 1-4 complete.
</code></pre></div></p>
<h2 id="statistics">Statistics<a class="headerlink" href="#statistics" title="Permanent link">&para;</a></h2>
<p><strong>Lines Modified</strong>: ~85 lines changed/added in mbasic
<strong>New Features</strong>: 3 (--ui, --debug, dynamic loading)
<strong>Breaking Changes</strong>: 0 (100% backward compatible)
<strong>Time Spent</strong>: ~1 hour</p>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<h3 id="phase-5-mobilevisual-ui-deferred">Phase 5: Mobile/Visual UI (Deferred)<a class="headerlink" href="#phase-5-mobilevisual-ui-deferred" title="Permanent link">&para;</a></h3>
<p><strong>Status</strong>: Ready to begin evaluation</p>
<p><strong>Prerequisites (all complete):</strong>
- ✅ IOHandler interface (Phase 1)
- ✅ ProgramManager (Phase 2)
- ✅ UIBackend interface (Phase 3)
- ✅ Dynamic loading (Phase 4)</p>
<p><strong>Next actions:</strong>
1. Create MOBILE_UI_EVALUATION.md
2. Evaluate frameworks: Kivy, BeeWare, PWA
3. Build proof-of-concept for top choices
4. Choose framework for iOS/Android
5. Implement chosen backend</p>
<p><strong>Estimated time</strong>: 8-20 hours (depends on framework choice)</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p><strong>Phase 4: COMPLETE</strong> ✅✅✅</p>
<p>Dynamic backend loading is complete and production-ready:
- ✅ Command-line argument parsing working
- ✅ Dynamic backend loading via importlib
- ✅ CLI and visual backends load correctly
- ✅ All tests passing
- ✅ 100% backward compatible
- ✅ Extensible for future backends</p>
<p><strong>All 4 core phases complete:</strong>
- ✅ Phase 1: I/O Abstraction
- ✅ Phase 2: Program Management
- ✅ Phase 3: UI Abstraction
- ✅ Phase 4: Dynamic Loading</p>
<p>The MBASIC interpreter is now fully embeddable, extensible, and ready for visual UI development!</p>
<p><strong>Ready for Phase 5</strong>: Mobile framework evaluation and implementation (when desired)</p>
<p>The refactoring is complete! 🎉</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/avwohl/mbasic" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>